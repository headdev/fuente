<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png" />
    <link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" href="images/apple-touch-startup-image-640x1096.png">
    
    <!--Css style starts here-->

    <link rel="stylesheet" href="css/themes/default/jquery.mobile-1.4.5.css">
    <link type="text/css" rel="stylesheet" href="style.css" />
    <link type="text/css" rel="stylesheet" href="css/colors/color.css" />
    
    <!--Css style ends here-->
    
    <!--Javascript Library Starts here-->
    
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery.mobile-1.4.5.min.js"></script>
    <script src="js/jquery.validate.min.js" type="text/javascript"></script>
    <script src="js/jquery.mobile-custom.js"></script>
    <script src="js/app.js"></script>
    <script src="js/moment.js"></script>
    
    <!--Javascript Library Ends here-->
    <style type="text/css">
    .button {
    background-color: #4CAF50; /* Green */
    border: none;
    color: white;
    padding: 4px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    -webkit-transition-duration: 0.4s; /* Safari */
    transition-duration: 0.4s;
    cursor: pointer;
    border-radius: 2px;
}

.button1 {
    background-color: white; 
    color: black; 
    border: 2px solid #4CAF50;
}

.button1:hover {
    background-color: #4CAF50;
    color: white;
}


.button3 {
    background-color: white; 
    color: black; 
    border: 2px solid #f44336;
}

.button3:hover {
    background-color: #f44336;
    color: white;
}
.amount-top h2{
    padding: 10px 0px;
}
 </style>
</head>

<body>
    <div data-role="page" id="features" class="secondarypage" data-theme="b">
        <header>
            <div data-role="header" data-position="fixed">
                <div class="nav_left_button"><a href="#" onclick="window.history.back();"><img src="images/icons/left-arrow.png" alt="" title="" /></a></div>
                <div class="nav_center_logo">
                    <div class="p-title">
                        <h2 style="font-size: 14px">Transaction Details</h2></div>
                </div>
                <div class="nav_right_button">
                    <a href="#right-panel"><img src="images/icons/icons8-align-justify-80.png" alt="" title="" /></a>
                </div>
                <div class="clear"></div>
            </div>
        </header>
        <!-- /header -->
        <div role="main" class="ui-content">
            <div class="pages_maincontent">
                <div class="page_content">
                    <section>
                        <div class="dboard-profile">
                            <div class="pro-left"><a href="#" class="editProfile" data-transition="slidefade"><img style="border-radius: 50%" class="image_src" src="images/author.png" alt="" title="" /></a> </div>
                            <div class="pro-right">
                                <h2 style="font-size: 16px" class="username"></h2>
                                <h4 style="font-size: 16px" class="userphone"></h4>
                            </div>
                        </div>
                    </section>
                    <section>
                        <div class="amount-top">
                            <div class="col-6">
                                <h2 style="font-size: 16px">Transaction Type</h2></div>
                            <div class="col-6">
                                <h2 style="font-size: 16px" class="tr_type"></h2></div>
                        </div>
                        <div class="amount-body">
                            <div class="col-6">
                                <h2 style="font-size: 16px" class="balance"></h2>
                            </div>
                            <div class="col-6">
                                <h3 style="font-size: 14px" class="tr_date"></h3>
                            </div>
                        </div>
                        <div class="message-body">
                            <div class="col-12">
                                 <h4 style="font-size: 12px" class="tr_msg"></h4>
                            </div>
                        </div>
                        <div class="amount-bottom">
                            <div class="col-12">
                                <h2 style="font-size: 14px" class="tr_id"></h2>
                            </div>
                        </div>
                        <div class="amount-bottom description">
                            <div class="col-12">
                                <h2 style="font-size: 14px" class="tr_desc"></h2>
                            </div>
                        </div>
                    </section>
                    <section>
                        
                        <ul class="features_list_detailed">
        
                            <span data-role="accept" action="accept-request-email" class="button button1 acceptrequest accept">Accept</span>
                            <span data-role="cancel" data-redirect="transaction.html" action="cancel-accept-request" class="button button3 cancelrequest cancel">Cancel</span>
                            <li>
                                <a href="#" class="SendMoneyProfile">
                                    <div class="feat_small_details">
                                        <h4 style="font-size: 16px;color: #232323">Send Money</h4>
                                    </div>
                                    <div class="view_more"><img src="images/icons/right-arrow.png" alt="" title="" /></div>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="RequestMoneyProfile">
                                    <div class="feat_small_details">
                                        <h4 style="font-size: 16px;color: #232323">Request Money</h4>
                                    </div>
                                    <div class="view_more"><img src="images/icons/right-arrow.png" alt="" title="" /></div>
                                </a>
                            </li>
                            <li>
                                <a href="#" class="withdrawMoney" data-transition="slidefade">
                                    <div class="feat_small_details">
                                        <h4 style="font-size: 16px;color: #232323">Withdraw Money</h4>
                                    </div>
                                    <div class="view_more"><img src="images/icons/right-arrow.png" alt="" title="" /></div>
                                </a>
                            </li>
                            <li>
                            <a href="#" class="exchangeMoney" data-transition="slidefade">
                                    <div class="feat_small_details">
                                        <h4 style="font-size: 16px;color: #232323">Exchange Money</h4>
                                    </div>
                                    <div class="view_more"><img src="images/icons/right-arrow.png" alt="" title="" /></div>
                                </a>
                            </li>
                        </ul>
                    </section>
                </div>
            </div>
        </div>
        <!-- /content -->
  <aside>
            <div data-role="panel" id="right-panel" data-display="reveal" data-position="right">
                <div class="user_login_info">
                    <div class="user_thumb_container">
                        <div class="user_thumb">
                            <img class="image_src" src="images/author.png" alt="" title="" />
                        </div>
                    </div>
                    <div class="user_details">
                        <p class="username" style="color:#fff;"></p>
                    </div>
                    <nav class="user-nav">
                        <ul>
                            <li class="dashboard"><a href="#"><img src="images/icons/right-arrow.png" alt="" title="" /><span style="font-size: 12px">Dashboard</span></a></li>
                            <li class="editProfile"><a href="#"><img src="images/icons/right-arrow.png" alt="" title="" /><span style="font-size: 12px">My Profile</span></a></li>
                            <li class="SendMoneyProfile"><a href="#"><img src="images/icons/right-arrow.png" alt="" title="" /><span style="font-size: 12px">Send Money</span></a></li>
                            <li class="RequestMoneyProfile"><a href="#"><img src="images/icons/right-arrow.png" alt="" title="" /><span style="font-size: 12px">Request Money</span></a></li>
                            <li class="withdrawMoney"><a href="#"><img src="images/icons/right-arrow.png" alt="" title="" /><span style="font-size: 12px">Withdraw Money</span></a></li>
                            <li class="exchangeMoney"><a href="#"><img src="images/icons/right-arrow.png" alt="" title="" /><span style="font-size: 12px">Exchange Money</span></a></li>
                            <li class="logout" style="cursor: pointer;" action="logout" data-redirect="login.html"><a><img src="images/icons/black/lock.png" alt="" title="" /><span style="font-size: 12px" class="log-out">Logout</span></a></li>
                        </ul>
                    </nav>
                </div>
                <div class="close_loginpopup_button"><a href="#" data-rel="close"><img src="images/icons/black/menu_close.png" alt="" title="" /></a></div>
            </div>
        </aside>
        <!-- /panel -->
    </div>
    <script type="text/javascript">
        $(window).on('load',function(){
            let username  = localStorage.getItem('username');
            let userphone = localStorage.getItem('phone');
            let user_id   = localStorage.getItem('user_id');
            $('.username').text(username);
            $('.userphone').text(userphone);

            //For getting Individual Transaction details

            let site_url  = localStorage.getItem('site_url');
            let url       = site_url+'transaction-details';
            let token     = localStorage.getItem('token');
            let tr_id     = localStorage.getItem('tr_id');
            $.ajax({
                    url   : url,
                    type  : "get",
                    async : false,
                    data  : {'tr_id':tr_id,'_token':token,'user_id':user_id},
                    dataType : 'json',
                    //data may contain three part status of 'success', 'message', 'errors' if success is 0 
                    success:function(data){
                        let date      = data.transactions.t_created_at;
                        let tr_date   = moment(date).format("DD MMMM YYYY"); //2014-07-10
                        let tr_ref_id = data.transactions.transaction_reference_id;
                        if(data.transactions.type=='Received'){
                            $type = "Money "+data.transactions.type;
                            $msg  = 'You '+data.transactions.type+' money from '+capitalizeFirstLetter(data.transactions.f_name)+" "+capitalizeFirstLetter(data.transactions.l_name);
                            $('.tr_type').text($type);
                            $('.balance').text(data.transactions.curr_symbol+data.transactions.total);
                            $('.tr_date').text(tr_date);
                            $('.tr_msg').text($msg);
                            $('.tr_id').text('Transaction Id # '+data.transactions.transaction_id);
                            if(data.transactions.description!=null){
                                $('.description').show();
                                $('.tr_desc').text(data.transactions.description);
                            }else{
                                $('.description').hide();
                            }
                            $('.accept').hide();
                            $('.cancel').hide();
                        }else if(data.transactions.type=='Transferred'){
                            $type = "Money Sent";
                            $msg  = 'You Sent '+' to '+capitalizeFirstLetter(data.transactions.f_name)+" "+capitalizeFirstLetter(data.transactions.l_name);
                            $('.tr_type').text($type);
                            $('.balance').text(data.transactions.curr_symbol+data.transactions.total);
                            $('.tr_date').text(tr_date);
                            $('.message-body').show();
                            $('.tr_msg').text($msg);
                            $('.tr_id').text('Transaction Id # '+data.transactions.transaction_id);
                            if(data.transactions.description!=null){
                                $('.description').show();
                                $('.tr_desc').text(data.transactions.description);
                            }else{
                                $('.description').hide();
                            }
                            $('.accept').hide();
                            $('.cancel').hide();
                        }else if(data.transactions.type=='Deposit'){
                            $type = "Deposit";
                            $('.tr_type').text($type);
                            $('.balance').text(data.transactions.curr_symbol+data.transactions.total);
                            $('.tr_date').text(tr_date);
                            $('.tr_id').text('Transaction Id # '+data.transactions.transaction_id);
                            if(data.transactions.description!=null){
                                $('.description').show();
                                $('.tr_desc').text(data.transactions.description);
                            }else{
                                $('.description').hide();
                            }
                            $('.message-body').hide();
                            $('.accept').hide();
                            $('.cancel').hide();

                        }else if(data.transactions.type=='Withdrawal'){
                            $type = "Withrawal";
                            $('.tr_type').text($type);
                            $('.balance').text(data.transactions.curr_symbol+data.transactions.total);
                            $('.tr_date').text(tr_date);
                            $('.tr_id').text('Transaction Id # '+data.transactions.transaction_id);
                            if(data.transactions.description!=null){
                                $('.description').show();
                                $('.tr_desc').text(data.transactions.description);
                            }else{
                                $('.description').hide();
                            }
                            $('.message-body').hide();
                            $('.accept').hide();
                            $('.cancel').hide();

                        }else if(data.transactions.type=='Voucher_Created'){
                            $type = "Voucher Created";
                            $('.tr_type').text($type);
                            $('.balance').text(data.transactions.curr_symbol+data.transactions.total);
                            $('.tr_date').text(tr_date);
                            $('.tr_id').text('Transaction Id # '+data.transactions.transaction_id);
                            if(data.transactions.description!=null){
                                $('.description').show();
                                $('.tr_desc').text(data.transactions.description);
                            }else{
                                $('.description').hide();
                            }
                            $('.message-body').hide();
                            $('.accept').hide();
                            $('.cancel').hide();

                        }else if(data.transactions.type=='Voucher_Activated'){
                            $type = "Voucher Activated";
                            $('.tr_type').text($type);
                            $('.balance').text(data.transactions.curr_symbol+data.transactions.total);
                            $('.tr_date').text(tr_date);
                            $('.tr_id').text('Transaction Id # '+data.transactions.transaction_id);
                            if(data.transactions.description!=null){
                                $('.description').show();
                                $('.tr_desc').text(data.transactions.description);
                            }else{
                                $('.description').hide();
                            }
                            $('.message-body').hide();
                            $('.accept').hide();
                            $('.cancel').hide();

                        }else if(data.transactions.type=='Request_From'){
                            $type   = "Request Sent";
                            $msg    = 'You are requesting money from '+capitalizeFirstLetter(data.transactions.f_name)+" "+capitalizeFirstLetter(data.transactions.l_name);
                            $status = data.transactions.status;
                            $('.tr_type').text($type);
                            $('.balance').text(data.transactions.curr_symbol+data.transactions.total);
                            $('.tr_date').text(tr_date);
                            $('.message-body').show();
                            $('.tr_msg').text($msg);
                            $('.tr_id').text('Transaction Id # '+data.transactions.transaction_id);
                            if(data.transactions.description!=null){
                                $('.description').show();
                                $('.tr_desc').text(data.transactions.description);
                            }else{
                                $('.description').hide();
                            }
                            if($status=='Pending'){
                                $('.accept').hide();
                                $('.accept').removeAttr('data-role');
                                $('.accept').removeAttr('data-id');
                                $('.cancel').show();
                                $('.cancel').attr('data-id',tr_id);
                            }else if($status=='Blocked'){
                                $('.accept').hide();
                                $('.accept').removeAttr('data-role');
                                $('.accept').removeAttr('data-id');
                                $('.cancel').hide();
                                $('.cancel').removeAttr('data-id');
                                
                            }else{
                                $('.accept').hide();
                                $('.accept').removeAttr('data-role');
                                $('.accept').removeAttr('data-id');
                                $('.cancel').show();
                                $('.cancel').attr('data-id',tr_id);
                            }
                            windowSize();//Set css style depend on window size
                        }else if(data.transactions.type=='Request_To'){
                            $type   = "Request Received";
                            $status = data.transactions.status;
                            $msg    = capitalizeFirstLetter(data.transactions.f_name)+" "+capitalizeFirstLetter(data.transactions.l_name)+' requested money from you';
                            $('.tr_type').text($type);
                            $('.balance').text(data.transactions.curr_symbol+data.transactions.total);
                            $('.tr_date').text(tr_date);
                            $('.tr_id').text('Transaction Id # '+data.transactions.transaction_id);
                            if(data.transactions.description!=null){
                                $('.description').show();
                                $('.tr_desc').text(data.transactions.description);
                            }else{
                                $('.description').hide();
                            }
                            $('.message-body').hide();
                            if($status=='Pending'){
                                $('.accept').show();
                                $('.accept').attr('data-role','accept');
                                $('.accept').attr('data-id',tr_ref_id);
                                $('.cancel').show();
                                $('.cancel').attr('data-id',tr_id);
                            }else if($status=='Blocked'){
                                $('.cancel').hide();
                                $('.cancel').removeAttr('data-id');
                                $('.accept').hide();
                            }else{
                                $('.accept').hide();
                                $('.accept').removeAttr('data-role'); 
                                $('.accept').removeAttr('data-id');
                                $('.cancel').show();
                                $('.cancel').attr('data-id',tr_id);
                            }
                            windowSize();//Set css style depend on window size
                        }else if(data.transactions.type=='Exchange_From'){
                            $type = "Exchange From";
                            $msg  = capitalizeFirstLetter(data.transactions.f_name)+" "+capitalizeFirstLetter(data.transactions.l_name)+' requested money from you';
                            $('.tr_type').text($type);
                            $('.balance').text(data.transactions.curr_symbol+data.transactions.total);
                            $('.tr_date').text(tr_date);
                            $('.tr_id').text('Transaction Id # '+data.transactions.transaction_id);
                            if(data.transactions.description!=null){
                                $('.description').show();
                                $('.tr_desc').text(data.transactions.description);
                            }else{
                                $('.description').hide();
                            }
                            $('.message-body').hide();
                            $('.accept').hide();
                            $('.cancel').hide();

                        }else if(data.transactions.type=='Exchange_To'){
                            $type = "Exchange To";
                            $msg  = capitalizeFirstLetter(data.transactions.f_name)+" "+capitalizeFirstLetter(data.transactions.l_name)+' requested money from you';
                            $('.tr_type').text($type);
                            $('.balance').text(data.transactions.curr_symbol+data.transactions.total);
                            $('.tr_date').text(tr_date);
                            $('.tr_id').text('Transaction Id # '+data.transactions.transaction_id);
                            if(data.transactions.description!=null){
                                $('.description').show();
                                $('.tr_desc').text(data.transactions.description);
                            }else{
                                $('.description').hide();
                            }
                            $('.message-body').hide();
                            $('.accept').hide();
                            $('.cancel').hide();

                        }
                    },
                    error: function(error){
                        console.log(error);
                    }
                });
            
        });

        //Capitalize First Character of a string
        function capitalizeFirstLetter(string) {
            return string.charAt(0).toUpperCase() + string.slice(1);
        }

         //Window Size detection
        function windowSize(){
                let size   = $(window).width();
                let accept = $('.accept').attr('data-role');
                let cancel = $('.cancel').attr('data-role');
                if(size<=280){
                    if(accept=='accept' && cancel=='cancel'){
                        $('.acceptrequest').css({'width':'21%','float':'left'});
                        $('.cancelrequest').css({'width':'21%','float':'right'});
                    }else{
                       $('.acceptrequest').css({'width':'72%'}); 
                       $('.cancelrequest').css({'width':'72%'});
                    }
                }else if(size>285 && size<320){
                    if(accept=='accept' && cancel=='cancel'){
                        $('.acceptrequest').css({'width':'22%','float':'left'});
                        $('.cancelrequest').css({'width':'22%','float':'right'});
                    }else{
                       $('.acceptrequest').css({'width':'72%'});
                       $('.cancelrequest').css({'width':'72%'}); 
                    }
                }else if(size>280 && size<286){
                    if(accept=='accept' && cancel=='cancel'){
                        $('.acceptrequest').css({'width':'20%','float':'left'});
                        $('.cancelrequest').css({'width':'20%','float':'right'});
                    }else{
                       $('.acceptrequest').css({'width':'72%'});
                       $('.cancelrequest').css({'width':'72%'});  
                    }
                }else{
                    if(accept=='accept' && cancel=='cancel'){
                        $('.acceptrequest').css({'width':'25%','float':'left'});
                        $('.cancelrequest').css({'width':'25%','float':'right'});
                    }else{
                       $('.acceptrequest').css({'width':'75%'});
                       $('.cancelrequest').css({'width':'75%'});  
                    }
                }
        }
    </script>
</body>

</html>